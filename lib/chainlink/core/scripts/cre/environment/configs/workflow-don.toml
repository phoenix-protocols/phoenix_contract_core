
[[blockchains]]
  type = "anvil"
  chain_id = "1337"
  docker_cmd_params = ["-b", "0.5", "--mixed-mining"]

[[blockchains]]
  type = "anvil"
  chain_id = "2337"
  port = "8546"
  docker_cmd_params = ["-b", "0.5", "--mixed-mining"]

# in order for a node to connect to it either:
# - add any chain capability for it, e.g. read-contract = ["11155111"]
# - or add it to supported EVM chains, e.g. supported_evm_chains = [11155111, 1337, 2337]
# if supported_evm_chains is used it must include ALL chains that the node connects to, it is not enough to only add the extra chain_id
#[[blockchains]]
#  type = "anvil"
#  chain_id = "11155111"

# [blockchains.out]
#    use_cache = true
#    type = "anvil"
#    family = "evm"
#    chain_id = "11155111"

#    [[blockchains.out.nodes]]
#      ws_url = "wss://sepolia.gateway.tenderly.co/<api-key>"
#      http_url = "https://sepolia.gateway.tenderly.co/<api-key>"
#      internal_ws_url = "wss://sepolia.gateway.tenderly.co/<api-key>"
#      internal_http_url = "https://sepolia.gateway.tenderly.co/<api-key>"

[jd]
  # change to your version
  csa_encryption_key = "d1093c0060d50a3c89c189b2e485da5a3ce57f3dcb38ab7e2c0d5f0bb2314a44" # any random 32 byte hex string
  image = "job-distributor:0.22.1"

[fake]
  port = 8171

[fake_http]
  port = 8666

#[s3provider]
#  # use all defaults
#  port = 9000
#  console_port = 9001

[infra]
  # either "docker" or "crib"
  type = "docker"

#[infra.crib]
#  namespace = "crib-local"
#  folder_location = "/absolute/path/to/crib/deployments/cre"
#  provider = "kind"  # or "aws"

[[nodesets]]
  nodes = 5
  name = "workflow"
  don_types = ["workflow", "gateway"]
  override_mode = "each"
  http_port_range_start = 10100

  # supported_evm_chains = [1337, 2337, 11155111] # uncomment to connect the node to Sepolia, even though there are no capabilities using it
  env_vars = { CL_EVM_CMD = "" }
  capabilities = ["ocr3", "custom-compute", "web-api-target", "web-api-trigger", "vault", "cron", "http-action", "http-trigger", "consensus", "don-time"]

  # Enable capabilities per chain with optional per-chain overrides
  [nodesets.chain_capabilities]
    write-evm = ["1337", "2337"]
    read-contract = ["1337", "2337"]
    evm = ["1337"]

  # See ./examples/workflow-don-overrides.toml to learn how to override capability configs

  [nodesets.db]
    image = "postgres:12.0"
    port = 13000

  [[nodesets.node_specs]]
    roles = ["bootstrap", "gateway"]
    [nodesets.node_specs.node]
      docker_ctx = "../../../.."
      docker_file = "core/chainlink.Dockerfile"
      docker_build_args = { "CL_IS_PROD_BUILD" = "false" }
      #image = "chainlink-tmp:latest"
      # 5002 is the web API capabilities port for incoming requests
      # 15002 is the vault port for incoming requests
      custom_ports = ["5002:5002","15002:15002"]
      user_config_overrides = ""

  [[nodesets.node_specs]]
    roles = ["plugin"]
    [nodesets.node_specs.node]
      docker_ctx = "../../../.."
      docker_file = "core/chainlink.Dockerfile"
      docker_build_args = { "CL_IS_PROD_BUILD" = "false" }
      #image = "chainlink-tmp:latest"
      user_config_overrides = ""

  [[nodesets.node_specs]]
    roles = ["plugin"]
    [nodesets.node_specs.node]
      docker_ctx = "../../../.."
      docker_file = "core/chainlink.Dockerfile"
      docker_build_args = { "CL_IS_PROD_BUILD" = "false" }
      #image = "chainlink-tmp:latest"
      user_config_overrides = ""

  [[nodesets.node_specs]]
    roles = ["plugin"]
    [nodesets.node_specs.node]
      docker_ctx = "../../../.."
      docker_file = "core/chainlink.Dockerfile"
      docker_build_args = { "CL_IS_PROD_BUILD" = "false" }
      #image = "chainlink-tmp:latest"
      user_config_overrides = ""

  [[nodesets.node_specs]]
    roles = ["plugin"]
    [nodesets.node_specs.node]
      docker_ctx = "../../../.."
      docker_file = "core/chainlink.Dockerfile"
      docker_build_args = { "CL_IS_PROD_BUILD" = "false" }
      #image = "chainlink-tmp:latest"
      user_config_overrides = ""
